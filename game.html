<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Street Fighter 2D Game</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }
        
        #gameCanvas {
            border: 2px solid #333;
            background: #000;
        }
        
        .controls {
            position: absolute;
            top: 10px;
            left: 10px;
            color: white;
            font-size: 12px;
        }
        
        .player1-controls {
            top: 10px;
            left: 10px;
        }
        
        .player2-controls {
            top: 10px;
            right: 10px;
        }
    </style>
</head>
<body>
    <div class="controls player1-controls">
        <h3>Player 1 (Blue)</h3>
        <p>A/D - Move Left/Right</p>
        <p>W - Jump</p>
        <p>S - Crouch</p>
        <p>Q - Punch</p>
        <p>E - Kick</p>
    </div>
    
    <div class="controls player2-controls">
        <h3>Player 2 (Red)</h3>
        <p>←/→ - Move Left/Right</p>
        <p>↑ - Jump</p>
        <p>↓ - Crouch</p>
        <p>N - Punch</p>
        <p>M - Kick</p>
    </div>
    
    <canvas id="gameCanvas" width="1000" height="600"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Game state
        const game = {
            width: canvas.width,
            height: canvas.height,
            gravity: 0.8,
            friction: 0.85
        };

        // Input handling
        const keys = {};
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
        });
        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });

        // Fighter class
        class Fighter {
            constructor(x, y, color, controls) {
                this.x = x;
                this.y = y;
                this.width = 60;
                this.height = 100;
                this.color = color;
                this.controls = controls;
                
                // Movement properties
                this.vx = 0;
                this.vy = 0;
                this.speed = 5;
                this.jumpPower = -15;
                this.onGround = false;
                
                // Animation properties
                this.animationFrame = 0;
                this.animationSpeed = 0.2;
                this.currentAnimation = 'idle';
                this.animationComplete = true;
                
                // Combat properties
                this.health = 100;
                this.facing = 1; // 1 for right, -1 for left
                this.attacking = false;
                this.attackType = null;
                this.attackCooldown = 0;
                
                // Animation states
                this.animations = {
                    idle: { frames: 4, duration: 1000 },
                    walk: { frames: 6, duration: 800 },
                    jump: { frames: 3, duration: 500 },
                    crouch: { frames: 2, duration: 300 },
                    punch: { frames: 4, duration: 400 },
                    kick: { frames: 5, duration: 500 }
                };
            }

            update() {
                this.handleInput();
                this.updatePhysics();
                this.updateAnimation();
                this.updateAttack();
            }

            handleInput() {
                if (this.attackCooldown > 0) return;

                // Movement
                if (keys[this.controls.left]) {
                    this.vx = -this.speed;
                    this.facing = -1;
                    this.currentAnimation = 'walk';
                } else if (keys[this.controls.right]) {
                    this.vx = this.speed;
                    this.facing = 1;
                    this.currentAnimation = 'walk';
                } else {
                    this.vx *= this.friction;
                    if (Math.abs(this.vx) < 0.1) {
                        this.vx = 0;
                        if (this.onGround && !this.attacking) {
                            this.currentAnimation = 'idle';
                        }
                    }
                }

                // Jumping
                if (keys[this.controls.jump] && this.onGround) {
                    this.vy = this.jumpPower;
                    this.onGround = false;
                    this.currentAnimation = 'jump';
                }

                // Crouching
                if (keys[this.controls.crouch] && this.onGround) {
                    this.currentAnimation = 'crouch';
                    this.vx *= 0.5; // Slow down when crouching
                }

                // Attacks
                if (keys[this.controls.punch] && this.onGround && !this.attacking) {
                    this.attack('punch');
                }
                if (keys[this.controls.kick] && this.onGround && !this.attacking) {
                    this.attack('kick');
                }
            }

            attack(type) {
                this.attacking = true;
                this.attackType = type;
                this.currentAnimation = type;
                this.animationFrame = 0;
                this.animationComplete = false;
                this.attackCooldown = 30;
            }

            updateAttack() {
                if (this.attackCooldown > 0) {
                    this.attackCooldown--;
                }
            }

            updatePhysics() {
                // Apply gravity
                this.vy += game.gravity;
                
                // Update position
                this.x += this.vx;
                this.y += this.vy;
                
                // Ground collision
                if (this.y >= game.height - this.height - 50) {
                    this.y = game.height - this.height - 50;
                    this.vy = 0;
                    this.onGround = true;
                } else {
                    this.onGround = false;
                }
                
                // Screen boundaries
                if (this.x < 0) this.x = 0;
                if (this.x > game.width - this.width) this.x = game.width - this.width;
            }

            updateAnimation() {
                const anim = this.animations[this.currentAnimation];
                if (!anim) return;

                this.animationFrame += this.animationSpeed;
                
                if (this.animationFrame >= anim.frames) {
                    if (this.attacking) {
                        this.attacking = false;
                        this.attackType = null;
                        this.currentAnimation = 'idle';
                    }
                    this.animationFrame = 0;
                }
            }

            draw() {
                ctx.save();
                
                // Flip sprite if facing left
                if (this.facing === -1) {
                    ctx.scale(-1, 1);
                    ctx.translate(-this.x - this.width, 0);
                } else {
                    ctx.translate(this.x, 0);
                }
                
                // Draw fighter body
                ctx.fillStyle = this.color;
                ctx.fillRect(0, this.y, this.width, this.height);
                
                // Draw head
                ctx.fillStyle = '#FFDBAC';
                ctx.fillRect(15, this.y - 20, 30, 30);
                
                // Draw eyes
                ctx.fillStyle = '#000';
                ctx.fillRect(20, this.y - 15, 5, 5);
                ctx.fillRect(35, this.y - 15, 5, 5);
                
                // Draw arms and legs based on animation
                this.drawLimbs();
                
                ctx.restore();
            }

            drawLimbs() {
                const frame = Math.floor(this.animationFrame);
                const anim = this.currentAnimation;
                
                ctx.fillStyle = this.color;
                
                if (anim === 'punch') {
                    // Punch animation
                    const punchOffset = frame * 8;
                    ctx.fillRect(50 + punchOffset, this.y + 20, 25, 15); // Right arm
                    ctx.fillRect(15, this.y + 20, 15, 15); // Left arm
                } else if (anim === 'kick') {
                    // Kick animation
                    const kickOffset = frame * 6;
                    ctx.fillRect(20, this.y + 80, 15, 20); // Left leg
                    ctx.fillRect(25 + kickOffset, this.y + 70, 20, 25); // Right leg
                } else {
                    // Default arms and legs
                    ctx.fillRect(50, this.y + 20, 20, 15); // Right arm
                    ctx.fillRect(10, this.y + 20, 20, 15); // Left arm
                    ctx.fillRect(20, this.y + 80, 15, 20); // Left leg
                    ctx.fillRect(25, this.y + 80, 15, 20); // Right leg
                }
            }

            getAttackBox() {
                if (!this.attacking) return null;
                
                const attackRange = this.attackType === 'punch' ? 40 : 50;
                const attackHeight = this.attackType === 'punch' ? 30 : 40;
                
                return {
                    x: this.facing === 1 ? this.x + this.width : this.x - attackRange,
                    y: this.y + 20,
                    width: attackRange,
                    height: attackHeight
                };
            }

            takeDamage(damage) {
                this.health -= damage;
                if (this.health < 0) this.health = 0;
            }
        }

        // Background class
        class Background {
            constructor() {
                this.stars = [];
                this.lights = [];
                this.generateStars();
                this.generateLights();
            }

            generateStars() {
                for (let i = 0; i < 100; i++) {
                    this.stars.push({
                        x: Math.random() * game.width,
                        y: Math.random() * game.height * 0.6,
                        size: Math.random() * 2 + 1,
                        twinkle: Math.random() * Math.PI * 2
                    });
                }
            }

            generateLights() {
                for (let i = 0; i < 20; i++) {
                    this.lights.push({
                        x: Math.random() * game.width,
                        y: game.height - 100 + Math.random() * 50,
                        size: Math.random() * 15 + 10,
                        intensity: Math.random() * 0.5 + 0.5
                    });
                }
            }

            update() {
                // Update star twinkling
                this.stars.forEach(star => {
                    star.twinkle += 0.05;
                });
            }

            draw() {
                // Draw night sky gradient
                const gradient = ctx.createLinearGradient(0, 0, 0, game.height);
                gradient.addColorStop(0, '#0a0a2e');
                gradient.addColorStop(0.5, '#16213e');
                gradient.addColorStop(1, '#0f3460');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, game.width, game.height);

                // Draw stars
                ctx.fillStyle = '#ffffff';
                this.stars.forEach(star => {
                    const alpha = 0.5 + Math.sin(star.twinkle) * 0.3;
                    ctx.globalAlpha = alpha;
                    ctx.fillRect(star.x, star.y, star.size, star.size);
                });
                ctx.globalAlpha = 1;

                // Draw city lights
                this.lights.forEach(light => {
                    const gradient = ctx.createRadialGradient(
                        light.x, light.y, 0,
                        light.x, light.y, light.size
                    );
                    gradient.addColorStop(0, `rgba(255, 255, 100, ${light.intensity})`);
                    gradient.addColorStop(1, 'rgba(255, 255, 100, 0)');
                    ctx.fillStyle = gradient;
                    ctx.fillRect(light.x - light.size, light.y - light.size, 
                                light.size * 2, light.size * 2);
                });

                // Draw ground
                ctx.fillStyle = '#2a2a2a';
                ctx.fillRect(0, game.height - 50, game.width, 50);
            }
        }

        // Game objects
        const background = new Background();
        const player1 = new Fighter(200, 0, '#4a90e2', {
            left: 'a',
            right: 'd',
            jump: 'w',
            crouch: 's',
            punch: 'q',
            kick: 'e'
        });
        const player2 = new Fighter(700, 0, '#e74c3c', {
            left: 'arrowleft',
            right: 'arrowright',
            jump: 'arrowup',
            crouch: 'arrowdown',
            punch: 'n',
            kick: 'm'
        });

        // Collision detection
        function checkCollisions() {
            const attack1 = player1.getAttackBox();
            const attack2 = player2.getAttackBox();

            if (attack1 && !player2.attacking) {
                if (player2.x < attack1.x + attack1.width &&
                    player2.x + player2.width > attack1.x &&
                    player2.y < attack1.y + attack1.height &&
                    player2.y + player2.height > attack1.y) {
                    player2.takeDamage(10);
                }
            }

            if (attack2 && !player1.attacking) {
                if (player1.x < attack2.x + attack2.width &&
                    player1.x + player1.width > attack2.x &&
                    player1.y < attack2.y + attack2.height &&
                    player1.y + player1.height > attack2.y) {
                    player1.takeDamage(10);
                }
            }
        }

        // Draw health bars
        function drawHealthBars() {
            const barWidth = 200;
            const barHeight = 20;
            const barY = 20;

            // Player 1 health bar
            ctx.fillStyle = '#333';
            ctx.fillRect(20, barY, barWidth, barHeight);
            ctx.fillStyle = '#4a90e2';
            ctx.fillRect(20, barY, (player1.health / 100) * barWidth, barHeight);

            // Player 2 health bar
            ctx.fillStyle = '#333';
            ctx.fillRect(game.width - barWidth - 20, barY, barWidth, barHeight);
            ctx.fillStyle = '#e74c3c';
            ctx.fillRect(game.width - barWidth - 20, barY, (player2.health / 100) * barWidth, barHeight);

            // Health text
            ctx.fillStyle = '#fff';
            ctx.font = '16px Arial';
            ctx.fillText(`P1: ${player1.health}`, 20, barY - 5);
            ctx.fillText(`P2: ${player2.health}`, game.width - 100, barY - 5);
        }

        // Game loop
        function gameLoop() {
            // Clear canvas
            ctx.clearRect(0, 0, game.width, game.height);

            // Update game objects
            background.update();
            player1.update();
            player2.update();
            checkCollisions();

            // Draw everything
            background.draw();
            player1.draw();
            player2.draw();
            drawHealthBars();

            // Check for game over
            if (player1.health <= 0 || player2.health <= 0) {
                ctx.fillStyle = '#fff';
                ctx.font = '48px Arial';
                ctx.textAlign = 'center';
                const winner = player1.health <= 0 ? 'Player 2 Wins!' : 'Player 1 Wins!';
                ctx.fillText(winner, game.width / 2, game.height / 2);
                ctx.font = '24px Arial';
                ctx.fillText('Press F5 to restart', game.width / 2, game.height / 2 + 50);
                return;
            }

            requestAnimationFrame(gameLoop);
        }

        // Start the game
        gameLoop();
    </script>
</body>
</html>
